name = "leaselab-rowbase-rio-sync-worker"
main = "src/index.ts"
compatibility_date = "2024-11-13"

# Production Environment (default)
# D1 Database Binding
[[d1_databases]]
binding = "D1_DATABASE"
database_name = "rio-baserow-core"
database_id = "beace8f5-e60e-4071-b018-d93d8a2cae9b" 

# R2 Bucket Binding
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "rio-images"

# Cron Triggers (scheduled sync)
# Uncomment and adjust schedule as needed
# Examples:
# - "0 * * * *" = Every hour
# - "0 0 * * *" = Daily at midnight
# - "0 */6 * * *" = Every 6 hours
[triggers]
crons = ["0 * * * *"]  # Default: Every hour

# Environment Variables (non-sensitive)
[vars]
# Airtable configuration (can also be set as secrets for security)
# AIRTABLE_TABLE_NAME = "Properties"  # Optional, defaults to "Properties"

# Secrets (add via: npx wrangler secret put SECRET_NAME)
# Required:
# - GOOGLE_DRIVE_API_KEY (or GOOGLE_SERVICE_ACCOUNT_JSON)
# - BASEROW_API_TOKEN (Baserow API authentication token)
# - BASEROW_DATABASE_ID (Database ID, default: 321013)
# - WEBHOOK_SECRET (Secret for Baserow webhook verification)
# - SYNC_SECRET (required for securing manual trigger endpoint - Bearer token authentication)

# Observability Configuration
[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true

# Demo Environment
[env.demo]
name = "leaselab-rowbase-rio-sync-worker-demo"

# D1 Database Binding for Demo
[[env.demo.d1_databases]]
binding = "D1_DATABASE"
database_name = "rio-baserow-core-demo"
database_id = "9d5ca81c-257f-4d51-aa20-eaeb88ea9d65"  

# R2 Bucket Binding for Demo
# Commented out until bucket is created
# [[env.demo.r2_buckets]]
# binding = "R2_BUCKET"
# bucket_name = "rio-images-demo"

# Cron Triggers for Demo
[env.demo.triggers]
crons = ["0 * * * *"]  # Default: Every hour

# Secrets for demo (add via: npx wrangler secret put SECRET_NAME --env demo)
# Required:
# - GOOGLE_DRIVE_API_KEY (or GOOGLE_SERVICE_ACCOUNT_JSON)
# - BASEROW_API_TOKEN (Baserow API authentication token)
# - BASEROW_DATABASE_ID (Database ID, default: 321013)
# - WEBHOOK_SECRET (Secret for Baserow webhook verification)
# - SYNC_SECRET (required for securing manual trigger endpoint - Bearer token authentication)

# Observability Configuration for Demo
[env.demo.observability]
[env.demo.observability.logs]
enabled = false
head_sampling_rate = 1
invocation_logs = true
persist = true

